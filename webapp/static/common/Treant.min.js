(function(){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(b||0,a.length)===a});var n=null,w={inheritAttrs:function(a,b){for(var e in b)b.hasOwnProperty(e)&&(a[e]instanceof Object&&b[e]instanceof Object&&"function"!==typeof b[e]?this.inheritAttrs(a[e],b[e]):a[e]=b[e]);return a},createMerge:function(a,b){var e={};a&&this.inheritAttrs(e,this.cloneObj(a));b&&this.inheritAttrs(e,b);return e},extend:function(){return n?(Array.prototype.unshift.apply(arguments,
[!0,{}]),n.extend.apply(n,arguments)):w.createMerge.apply(this,arguments)},cloneObj:function(a){if(Object(a)!==a)return a;var b=new a.constructor,e;for(e in a)a.hasOwnProperty(e)&&(b[e]=this.cloneObj(a[e]));return b},addEvent:function(a,b,e){if(n)n(a).on(b+".treant",e);else a.addEventListener?a.addEventListener(b,e,!1):a.attachEvent?a.attachEvent("on"+b,e):a["on"+b]=e},findEl:function(a,b,e){e=e||document;if(n)return a=n(a,e),b?a.get(0):a;if("#"===a.charAt(0))return e.getElementById(a.substring(1));
if("."===a.charAt(0))return b=e.getElementsByClassName(a.substring(1)),b.length?b[0]:null;throw Error("Unknown container element");},getOuterHeight:function(a){return"function"===typeof a.getBoundingClientRect?a.getBoundingClientRect().height:n?Math.ceil(n(a).outerHeight())+1:Math.ceil(a.clientHeight+w.getStyle(a,"border-top-width",!0)+w.getStyle(a,"border-bottom-width",!0)+w.getStyle(a,"padding-top",!0)+w.getStyle(a,"padding-bottom",!0)+1)},getOuterWidth:function(a){return"function"===typeof a.getBoundingClientRect?
a.getBoundingClientRect().width:n?Math.ceil(n(a).outerWidth())+1:Math.ceil(a.clientWidth+w.getStyle(a,"border-left-width",!0)+w.getStyle(a,"border-right-width",!0)+w.getStyle(a,"padding-left",!0)+w.getStyle(a,"padding-right",!0)+1)},getStyle:function(a,b,e){var f="";document.defaultView&&document.defaultView.getComputedStyle?f=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),f=a.currentStyle[b]);return e?
parseFloat(f):f},addClass:function(a,b){n?n(a).addClass(b):w.hasClass(a,b)||(a.classList?a.classList.add(b):a.className+=" "+b)},hasClass:function(a,b){return-1<(" "+a.className+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")},toggleClass:function(a,b,e){n?n(a).toggleClass(b,e):e?a.classList.add(b):a.classList.remove(b)},setDimensions:function(a,b,e){n?n(a).width(b).height(e):(a.style.width=b+"px",a.style.height=e+"px")},isjQueryAvailable:function(){return"undefined"!==typeof n&&n}},sb=function(){this.reset()};
sb.prototype={reset:function(){this.loading=[];return this},processNode:function(a){for(var b=a.nodeDOM.getElementsByTagName("img"),e=b.length;e--;)this.create(a,b[e]);return this},removeAll:function(a){for(var b=this.loading.length;b--;)this.loading[b]===a&&this.loading.splice(b,1);return this},create:function(a,b){function e(){f.removeAll(h);a.width=a.nodeDOM.offsetWidth;a.height=a.nodeDOM.offsetHeight}var f=this,h=b.src;if(0!==b.src.indexOf("data:")){this.loading.push(h);if(b.complete)return e();
w.addEvent(b,"load",e);w.addEvent(b,"error",e);b.src+=(0<b.src.indexOf("?")?"&":"?")+(new Date).getTime()}else e()},isNotLoading:function(){return 0===this.loading.length}};var rb={store:[],createTree:function(a){var b=this.store.length;this.store.push(new nb(a,b));return this.get(b)},get:function(a){return this.store[a]},destroy:function(a){var b=this.get(a);if(b){b._R.remove();for(b=b.drawArea;b.firstChild;)b.removeChild(b.firstChild);for(var e=b.className.split(" "),f=[],h=0;h<e.length;h++){var r=
e[h];"Treant"!==r&&"Treant-loaded"!==r&&f.push(r)}b.style.overflowY="";b.style.overflowX="";b.className=f.join(" ");this.store[a]=null}return this}},nb=function(a,b){this.reset=function(a,b){this.initJsonConfig=a;this.id=this.initTreeId=b;this.CONFIG=w.extend(nb.CONFIG,a.chart);this.drawArea=w.findEl(this.CONFIG.container,!0);if(!this.drawArea)throw Error('Failed to find element by selector "'+this.CONFIG.container+'"');w.addClass(this.drawArea,"Treant");this.drawArea.innerHTML="";this.imageLoader=
new sb;this.nodeDB=new tb(a.nodeStructure,this);this.connectionStore={};this.loaded=!1;this._R=new Raphael(this.drawArea,100,100);return this};this.reload=function(){this.reset(this.initJsonConfig,this.initTreeId).redraw();return this};this.reset(a,b)};nb.prototype={getNodeDb:function(){return this.nodeDB},addNode:function(a,b){this.nodeDB.get(a.id);this.CONFIG.callback.onBeforeAddNode.apply(this,[a,b]);var e=this.nodeDB.createNode(b,a.id,this);e.createGeometry(this);e.parent().createSwitchGeometry(this);
this.positionTree();this.CONFIG.callback.onAfterAddNode.apply(this,[e,a,b]);return e},redraw:function(){this.positionTree();return this},positionTree:function(a){var b=this;if(this.imageLoader.isNotLoading()){var e=this.root();this.resetLevelData();this.firstWalk(e,0);this.secondWalk(e,0,0,0);this.positionNodes();this.CONFIG.animateOnInit&&setTimeout(function(){e.toggleCollapse()},this.CONFIG.animateOnInitDelay);this.loaded||(w.addClass(this.drawArea,"Treant-loaded"),"[object Function]"===Object.prototype.toString.call(a)&&
a(b),b.CONFIG.callback.onTreeLoaded.apply(b,[e]),this.loaded=!0)}else setTimeout(function(){b.positionTree(a)},10);return this},firstWalk:function(a,b){a.prelim=null;a.modifier=null;this.setNeighbors(a,b);this.calcLevelDim(a,b);var e=a.leftSibling();if(0===a.childrenCount()||b==this.CONFIG.maxDepth)a.prelim=e?e.prelim+e.size()+this.CONFIG.siblingSeparation:0;else{for(var f=0,h=a.childrenCount();f<h;f++)this.firstWalk(a.childAt(f),b+1);f=a.childrenCenter()-a.size()/2;e?(a.prelim=e.prelim+e.size()+
this.CONFIG.siblingSeparation,a.modifier=a.prelim-f,this.apportion(a,b)):a.prelim=f;a.stackParent?a.modifier+=this.nodeDB.get(a.stackChildren[0]).size()/2+a.connStyle.stackIndent:a.stackParentId&&(a.prelim=0)}return this},apportion:function(a,b){var e=a.firstChild(),f=e.leftNeighbor(),h=1;for(b=this.CONFIG.maxDepth-b;e&&f&&h<=b;){for(var r=0,y=0,db=f,x=e,n=0;n<h;n++)db=db.parent(),x=x.parent(),y+=db.modifier,r+=x.modifier,void 0!==x.stackParent&&(r+=x.size()/2);r=f.prelim+y+f.size()+this.CONFIG.subTeeSeparation-
(e.prelim+r);if(0<r){x=a;for(y=0;x&&x.id!==db.id;)x=x.leftSibling(),y++;if(x)for(x=a,y=r/y;x.id!==db.id;)x.prelim+=r,x.modifier+=r,r-=y,x=x.leftSibling()}h++;(e=0===e.childrenCount()?a.leftMost(0,h):e=e.firstChild())&&(f=e.leftNeighbor())}},secondWalk:function(a,b,e,f){if(b<=this.CONFIG.maxDepth){var h=a.prelim+e,r=this.CONFIG.nodeAlign,y=this.CONFIG.rootOrientation;if("NORTH"===y||"SOUTH"===y){var db=this.levelMaxDim[b].height;var x=a.height;a.pseudo&&(a.height=db)}else if("WEST"===y||"EAST"===y)db=
this.levelMaxDim[b].width,x=a.width,a.pseudo&&(a.width=db);a.X=h;if(a.pseudo)if("NORTH"===y||"WEST"===y)a.Y=f;else{if("SOUTH"===y||"EAST"===y)a.Y=f+(db-x)}else a.Y="CENTER"===r?f+(db-x)/2:"TOP"===r?f+(db-x):f;if("WEST"===y||"EAST"===y)h=a.X,a.X=a.Y,a.Y=h;"SOUTH"===y?a.Y=-a.Y-x:"EAST"===y&&(a.X=-a.X-x);0!==a.childrenCount()&&(0===a.id&&this.CONFIG.hideRootNode?this.secondWalk(a.firstChild(),b+1,e+a.modifier,f):this.secondWalk(a.firstChild(),b+1,e+a.modifier,f+db+this.CONFIG.levelSeparation));a.rightSibling()&&
this.secondWalk(a.rightSibling(),b,e,f)}},positionNodes:function(){var a=this.nodeDB.getMinMaxCoord("X",null,null),b=this.nodeDB.getMinMaxCoord("Y",null,null),e=a.max-a.min,f=b.max-b.min,h={x:a.max-e/2,y:b.max-f/2};this.handleOverflow(e,f);var r={x:this.drawArea.clientWidth/2,y:this.drawArea.clientHeight/2},y=r.x-h.x,db=r.y-h.y;a=0>=a.min+y?Math.abs(a.min):0;b=0>=b.min+db?Math.abs(b.min):0;var x;var n=0;for(x=this.nodeDB.db.length;n<x;n++){var z=this.nodeDB.get(n);this.CONFIG.callback.onBeforePositionNode.apply(this,
[z,n,r,h]);if(0!==z.id||!this.CONFIG.hideRootNode){z.X+=a+(e<this.drawArea.clientWidth?y:this.CONFIG.padding);z.Y+=b+(f<this.drawArea.clientHeight?db:this.CONFIG.padding);var w=z.collapsedParent(),mb=null;w?(mb=w.connectorPoint(!0),z.hide(mb)):z.positioned?z.show():(z.nodeDOM.style.left=z.X+"px",z.nodeDOM.style.top=z.Y+"px",z.positioned=!0);0===z.id||0===z.parent().id&&this.CONFIG.hideRootNode?!this.CONFIG.hideRootNode&&z.drawLineThrough&&z.drawLineThroughMe():this.setConnectionToParent(z,mb)}this.CONFIG.callback.onAfterPositionNode.apply(this,
[z,n,r,h])}return this},handleOverflow:function(a,b){var e=a<this.drawArea.clientWidth?this.drawArea.clientWidth:a+2*this.CONFIG.padding,f=b<this.drawArea.clientHeight?this.drawArea.clientHeight:b+2*this.CONFIG.padding;this._R.setSize(e,f);"resize"===this.CONFIG.scrollbar?w.setDimensions(this.drawArea,e,f):w.isjQueryAvailable()&&"native"!==this.CONFIG.scrollbar?"fancy"===this.CONFIG.scrollbar&&(a=n(this.drawArea),a.hasClass("ps-container")?(a.find(".Treant").css({width:e,height:f}),a.perfectScrollbar("update")):
(a=a.wrapInner('<div class="Treant"/>'),a.find(".Treant").css({width:e,height:f}),a.perfectScrollbar())):(this.drawArea.clientWidth<a&&(this.drawArea.style.overflowX="auto"),this.drawArea.clientHeight<b&&(this.drawArea.style.overflowY="auto"));return this},setConnectionToParent:function(a,b){var e=a.stackParentId,f=e?this.nodeDB.get(e):a.parent(),h=b?this.getPointPathString(b):this.getPathString(f,a,e);this.connectionStore[a.id]?(e=this.connectionStore[a.id],this.animatePath(e,h)):(e=this._R.path(h),
this.connectionStore[a.id]=e,a.pseudo&&delete f.connStyle.style["arrow-end"],f.pseudo&&delete f.connStyle.style["arrow-start"],e.attr(f.connStyle.style),(a.drawLineThrough||a.pseudo)&&a.drawLineThroughMe(b));a.connector=e;return this},getPointPathString:function(a){return["_M",a.x,",",a.y,"L",a.x,",",a.y,a.x,",",a.y].join(" ")},animatePath:function(a,b){a.hidden&&"_"!==b.charAt(0)&&(a.show(),a.hidden=!1);a.animate({path:"_"===b.charAt(0)?b.substring(1):b},this.CONFIG.animation.connectorsSpeed,this.CONFIG.animation.connectorsAnimation,
function(){"_"===b.charAt(0)&&(a.hide(),a.hidden=!0)});return this},getPathString:function(a,b,e){var f=a.connectorPoint(!0);b=b.connectorPoint(!1);var h=this.CONFIG.rootOrientation,r=a.connStyle.type,y;if("NORTH"===h||"SOUTH"===h){var n=y=(f.y+b.y)/2;var x=f.x;var w=b.x}else if("EAST"===h||"WEST"===h)x=w=(f.x+b.x)/2,n=f.y,y=b.y;var z=f.x+","+f.y,mb=x+","+n,nb=w+","+y,ob=b.x+","+b.y;n=(x+w)/2+","+(n+y)/2;if(e)if(e="EAST"===h||"WEST"===h?b.x+","+f.y:f.x+","+b.y,"step"===r||"straight"===r)var pb=["M",
z,"L",e,"L",ob];else{if("curve"===r||"bCurve"===r){var qb;a=a.connStyle.stackIndent;"NORTH"===h?qb=b.x-a+","+(b.y-a):"SOUTH"===h?qb=b.x-a+","+(b.y+a):"EAST"===h?qb=b.x+a+","+f.y:"WEST"===h&&(qb=b.x-a+","+f.y);pb=["M",z,"L",qb,"S",e,ob]}}else"step"===r?pb=["M",z,"L",mb,"L",nb,"L",ob]:"curve"===r?pb=["M",z,"C",mb,nb,ob]:"bCurve"===r?pb=["M",z,"Q",mb,n,"T",ob]:"straight"===r&&(pb=["M",z,"L",z,ob]);return pb.join(" ")},setNeighbors:function(a,b){a.leftNeighborId=this.lastNodeOnLevel[b];a.leftNeighborId&&
(a.leftNeighbor().rightNeighborId=a.id);this.lastNodeOnLevel[b]=a.id;return this},calcLevelDim:function(a,b){this.levelMaxDim[b]={width:Math.max(this.levelMaxDim[b]?this.levelMaxDim[b].width:0,a.width),height:Math.max(this.levelMaxDim[b]?this.levelMaxDim[b].height:0,a.height)};return this},resetLevelData:function(){this.lastNodeOnLevel=[];this.levelMaxDim=[];return this},root:function(){return this.nodeDB.get(0)}};var tb=function(a,b){this.reset(a,b)};tb.prototype={reset:function(a,b){function e(a,
r){r=f.createNode(a,r,b,null);if(a.children){if(a.childrenDropLevel&&0<a.childrenDropLevel)for(;a.childrenDropLevel--;){var h=w.cloneObj(r.connStyle);r=f.createNode("pseudo",r.id,b,null);r.connStyle=h;r.children=[]}h=a.stackChildren&&!f.hasGrandChildren(a)?r.id:null;null!==h&&(r.stackChildren=[]);for(var n=0,x=a.children.length;n<x;n++)null!==h?(r=f.createNode(a.children[n],r.id,b,h),n+1<x&&(r.children=[])):e(a.children[n],r.id)}}this.db=[];var f=this;b.CONFIG.animateOnInit&&(a.collapsed=!0);e(a,
-1);this.createGeometries(b);return this},createGeometries:function(a){for(var b=this.db.length;b--;)this.get(b).createGeometry(a);return this},get:function(a){return this.db[a]},walk:function(a){for(var b=this.db.length;b--;)a.apply(this,[this.get(b)]);return this},createNode:function(a,b,e,f){e=new mb(a,this.db.length,b,e,f);this.db.push(e);0<=b&&(b=this.get(b),a.position?"left"===a.position?b.children.push(e.id):"right"===a.position?b.children.splice(0,0,e.id):"center"===a.position?b.children.splice(Math.floor(b.children.length/
2),0,e.id):(a=parseInt(a.position),1===b.children.length&&0<a?b.children.splice(0,0,e.id):b.children.splice(Math.max(a,b.children.length-1),0,e.id)):b.children.push(e.id));f&&(this.get(f).stackParent=!0,this.get(f).stackChildren.push(e.id));return e},getMinMaxCoord:function(a,b,e){b=b||this.get(0);e=e||{min:b[a],max:b[a]+("X"===a?b.width:b.height)};for(var f=b.childrenCount();f--;){var h=b.childAt(f),n=h[a]+("X"===a?h.width:h.height),y=h[a];n>e.max&&(e.max=n);y<e.min&&(e.min=y);this.getMinMaxCoord(a,
h,e)}return e},hasGrandChildren:function(a){for(var b=a.children.length;b--;)if(a.children[b].children)return!0;return!1}};var mb=function(a,b,e,f,h){this.reset(a,b,e,f,h)};mb.prototype={reset:function(a,b,e,f,h){this.id=b;this.parentId=e;this.treeId=f.id;this.modifier=this.prelim=0;this.leftNeighborId=null;this.stackParentId=h;this.pseudo="pseudo"===a||a.pseudo;this.meta=a.meta||{};this.image=a.image||null;this.link=w.createMerge(f.CONFIG.node.link,a.link);this.connStyle=w.createMerge(f.CONFIG.connectors,
a.connectors);this.connector=null;this.drawLineThrough=!1===a.drawLineThrough?!1:a.drawLineThrough||f.CONFIG.node.drawLineThrough;this.collapsable=!1===a.collapsable?!1:a.collapsable||f.CONFIG.node.collapsable;this.collapsed=a.collapsed;this.text=a.text;this.nodeInnerHTML=a.innerHTML;this.nodeHTMLclass=(f.CONFIG.node.HTMLclass?f.CONFIG.node.HTMLclass:"")+(a.HTMLclass?" "+a.HTMLclass:"");this.nodeHTMLid=a.HTMLid;this.children=[];return this},getTree:function(){return rb.get(this.treeId)},getTreeConfig:function(){return this.getTree().CONFIG},
getTreeNodeDb:function(){return this.getTree().getNodeDb()},lookupNode:function(a){return this.getTreeNodeDb().get(a)},Tree:function(){return rb.get(this.treeId)},dbGet:function(a){return this.getTreeNodeDb().get(a)},size:function(){var a=this.getTreeConfig().rootOrientation;if(this.pseudo)return-this.getTreeConfig().subTeeSeparation;if("NORTH"===a||"SOUTH"===a)return this.width;if("WEST"===a||"EAST"===a)return this.height},childrenCount:function(){return this.collapsed||!this.children?0:this.children.length},
childAt:function(a){return this.dbGet(this.children[a])},firstChild:function(){return this.childAt(0)},lastChild:function(){return this.childAt(this.children.length-1)},parent:function(){return this.lookupNode(this.parentId)},leftNeighbor:function(){if(this.leftNeighborId)return this.lookupNode(this.leftNeighborId)},rightNeighbor:function(){if(this.rightNeighborId)return this.lookupNode(this.rightNeighborId)},leftSibling:function(){var a=this.leftNeighbor();if(a&&a.parentId===this.parentId)return a},
rightSibling:function(){var a=this.rightNeighbor();if(a&&a.parentId===this.parentId)return a},childrenCenter:function(){var a=this.firstChild(),b=this.lastChild();return a.prelim+(b.prelim-a.prelim+b.size())/2},collapsedParent:function(){var a=this.parent();return a?a.collapsed?a:a.collapsedParent():!1},leftMost:function(a,b){if(a>=b)return this;if(0!==this.childrenCount())for(var e=0,f=this.childrenCount();e<f;e++){var h=this.childAt(e).leftMost(a+1,b);if(h)return h}},connectorPoint:function(a){var b=
this.Tree().CONFIG.rootOrientation,e={};if(this.stackParentId)if("NORTH"===b||"SOUTH"===b)b="WEST";else if("EAST"===b||"WEST"===b)b="NORTH";"NORTH"===b?(e.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,e.y=a?this.Y+this.height:this.Y):"SOUTH"===b?(e.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,e.y=a?this.Y:this.Y+this.height):"EAST"===b?(e.x=a?this.X:this.X+this.width,e.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+
this.height/2):"WEST"===b&&(e.x=a?this.X+this.width:this.X,e.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2);return e},pathStringThrough:function(){var a=this.connectorPoint(!0),b=this.connectorPoint(!1);return["M",a.x+","+a.y,"L",b.x+","+b.y].join(" ")},drawLineThroughMe:function(a){var b=a?this.Tree().getPointPathString(a):this.pathStringThrough();this.lineThroughMe=this.lineThroughMe||this.Tree()._R.path(b);b=w.cloneObj(this.connStyle.style);delete b["arrow-start"];
delete b["arrow-end"];this.lineThroughMe.attr(b);a&&(this.lineThroughMe.hide(),this.lineThroughMe.hidden=!0)},addSwitchEvent:function(a){var b=this;w.addEvent(a,"click",function(e){e.preventDefault();if(!1===b.getTreeConfig().callback.onBeforeClickCollapseSwitch.apply(b,[a,e]))return!1;b.toggleCollapse();b.getTreeConfig().callback.onAfterClickCollapseSwitch.apply(b,[a,e])})},collapse:function(){this.collapsed||this.toggleCollapse();return this},expand:function(){this.collapsed&&this.toggleCollapse();
return this},toggleCollapse:function(){var a=this.getTree();if(!a.inAnimation){a.inAnimation=!0;this.collapsed=!this.collapsed;w.toggleClass(this.nodeDOM,"collapsed",this.collapsed);a.positionTree();var b=this;setTimeout(function(){a.inAnimation=!1;a.CONFIG.callback.onToggleCollapseFinished.apply(a,[b,b.collapsed])},a.CONFIG.animation.nodeSpeed>a.CONFIG.animation.connectorsSpeed?a.CONFIG.animation.nodeSpeed:a.CONFIG.animation.connectorsSpeed)}return this},hide:function(a){a=a||!1;var b=this.hidden;
this.hidden=!0;this.nodeDOM.style.overflow="hidden";var e=this.getTree(),f=this.getTreeConfig(),h={opacity:0};a&&(h.left=a.x,h.top=a.y);!this.positioned||b?(this.nodeDOM.style.visibility="hidden",n?n(this.nodeDOM).css(h):(this.nodeDOM.style.left=h.left+"px",this.nodeDOM.style.top=h.top+"px"),this.positioned=!0):n?n(this.nodeDOM).animate(h,f.animation.nodeSpeed,f.animation.nodeAnimation,function(){this.style.visibility="hidden"}):(this.nodeDOM.style.transition="all "+f.animation.nodeSpeed+"ms ease",
this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.opacity=h.opacity,this.nodeDOM.style.left=h.left+"px",this.nodeDOM.style.top=h.top+"px",this.nodeDOM.style.visibility="hidden");this.lineThroughMe&&(f=e.getPointPathString(a),b?this.lineThroughMe.attr({path:f}):e.animatePath(this.lineThroughMe,e.getPointPathString(a)));return this},hideConnector:function(){var a=this.Tree(),b=a.connectionStore[this.id];b&&b.animate({opacity:0},a.CONFIG.animation.connectorsSpeed,a.CONFIG.animation.connectorsAnimation);
return this},show:function(){this.hidden=!1;this.nodeDOM.style.visibility="visible";this.Tree();var a={left:this.X,top:this.Y,opacity:1},b=this.getTreeConfig();n?n(this.nodeDOM).animate(a,b.animation.nodeSpeed,b.animation.nodeAnimation,function(){this.style.overflow=""}):(this.nodeDOM.style.transition="all "+b.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.left=a.left+"px",this.nodeDOM.style.top=a.top+"px",this.nodeDOM.style.opacity=a.opacity,
this.nodeDOM.style.overflow="");this.lineThroughMe&&this.getTree().animatePath(this.lineThroughMe,this.pathStringThrough());return this},showConnector:function(){var a=this.Tree(),b=a.connectionStore[this.id];b&&b.animate({opacity:1},a.CONFIG.animation.connectorsSpeed,a.CONFIG.animation.connectorsAnimation);return this}};mb.prototype.buildNodeFromText=function(a){this.image&&(image=document.createElement("img"),image.src=this.image,a.appendChild(image));if(this.text)for(var b in this.text)if(b.startsWith("data-"))a.setAttribute(b,
this.text[b]);else{var e=document.createElement(this.text[b].href?"a":"p");this.text[b].href&&(e.href=this.text[b].href,this.text[b].target&&(e.target=this.text[b].target));e.className="node-"+b;e.appendChild(document.createTextNode(this.text[b].val?this.text[b].val:this.text[b]instanceof Object?"'val' param missing!":this.text[b]));a.appendChild(e)}return a};mb.prototype.buildNodeFromHtml=function(a){if("#"===this.nodeInnerHTML.charAt(0)){var b=document.getElementById(this.nodeInnerHTML.substring(1));
b?(a=b.cloneNode(!0),a.id+="-clone",a.className+=" node"):a.innerHTML="<b> Wrong ID selector </b>"}else a.innerHTML=this.nodeInnerHTML;return a};mb.prototype.createGeometry=function(a){if(0===this.id&&a.CONFIG.hideRootNode)this.height=this.width=0;else{var b=a.drawArea,e=document.createElement(this.link.href?"a":"div");e.className=this.pseudo?"pseudo":mb.CONFIG.nodeHTMLclass;this.nodeHTMLclass&&!this.pseudo&&(e.className+=" "+this.nodeHTMLclass);this.nodeHTMLid&&(e.id=this.nodeHTMLid);this.link.href&&
(e.href=this.link.href,e.target=this.link.target);n?n(e).data("treenode",this):e.data={treenode:this};this.pseudo||(e=this.nodeInnerHTML?this.buildNodeFromHtml(e):this.buildNodeFromText(e),(this.collapsed||this.collapsable&&this.childrenCount()&&!this.stackParentId)&&this.createSwitchGeometry(a,e));a.CONFIG.callback.onCreateNode.apply(a,[this,e]);b.appendChild(e);this.width=e.offsetWidth;this.height=e.offsetHeight;this.nodeDOM=e;a.imageLoader.processNode(this)}};mb.prototype.createSwitchGeometry=
function(a,b){b=b||this.nodeDOM;var e=w.findEl(".collapse-switch",!0,b);e||(e=document.createElement("a"),e.className="collapse-switch",b.appendChild(e),this.addSwitchEvent(e),this.collapsed&&(b.className+=" collapsed"),a.CONFIG.callback.onCreateNodeCollapseSwitch.apply(a,[this,b,e]));return e};nb.CONFIG={maxDepth:100,rootOrientation:"NORTH",nodeAlign:"CENTER",levelSeparation:30,siblingSeparation:30,subTeeSeparation:30,hideRootNode:!1,animateOnInit:!1,animateOnInitDelay:500,padding:15,scrollbar:"native",
connectors:{type:"curve",style:{stroke:"black"},stackIndent:15},node:{link:{target:"_self"}},animation:{nodeSpeed:450,nodeAnimation:"linear",connectorsSpeed:450,connectorsAnimation:"linear"},callback:{onCreateNode:function(a,b){},onCreateNodeCollapseSwitch:function(a,b,e){},onAfterAddNode:function(a,b,e){},onBeforeAddNode:function(a,b){},onAfterPositionNode:function(a,b,e,f){},onBeforePositionNode:function(a,b,e,f){},onToggleCollapseFinished:function(a,b){},onAfterClickCollapseSwitch:function(a,b){},
onBeforeClickCollapseSwitch:function(a,b){},onTreeLoaded:function(a){}}};mb.CONFIG={nodeHTMLclass:"node"};var vb={make:function(a){var b=a.length;for(this.jsonStructure={chart:null,nodeStructure:null};b--;){var e=a[b];e.hasOwnProperty("container")?this.jsonStructure.chart=e:e.hasOwnProperty("parent")||e.hasOwnProperty("container")||(this.jsonStructure.nodeStructure=e,e._json_id=0)}this.findChildren(a);return this.jsonStructure},findChildren:function(a){for(var b=[0];b.length;){for(var e=b.pop(),f=
this.findNode(this.jsonStructure.nodeStructure,e),h=0,n=a.length,y=[];h<n;h++){var w=a[h];w.parent&&w.parent._json_id===e&&(w._json_id=this.getID(),delete w.parent,y.push(w),b.push(w._json_id))}y.length&&(f.children=y)}},findNode:function(a,b){var e,f;if(a._json_id===b)return a;if(a.children)for(e=a.children.length;e--;)if(f=this.findNode(a.children[e],b))return f},getID:function(){var a=1;return function(){return a++}}()},ub=function(a,b,e){a instanceof Array&&(a=vb.make(a));e&&(n=e);this.tree=rb.createTree(a);
this.tree.positionTree(b)};ub.prototype.destroy=function(){rb.destroy(this.tree.id)};window.Treant=ub})();
